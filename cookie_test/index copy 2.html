<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <!--<![endif]-->
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script
            src="https://code.jquery.com/jquery-3.6.0.min.js"
            integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
            crossorigin="anonymous"></script>
        <script src=./gdpr-cookie-master/gdpr-cookie.js></script>
        <script src=./js/js.cookie.min.js></script>

        <script async src="https://www.googletagmanager.com/gtag/js?id=G-X97H4Z8FNE"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-X97H4Z8FNE');
        </script>

        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script>
           

           
            Cookies.set('FPCPConfig', '1-1;2-0;3-1;4-1',{ expires: 365 });

            console.log(Cookies.get('FPCPConfig'));

            //Cookies.set('FPCPConfig', '1-1;2-1;3-1;4-1',{ expires: 365 });

            Cookies.set('Name1', 'Nilan', { expires: 365 });
            Cookies.set('Name2', 'Prasanna', { expires: 365 });
            Cookies.set('Name3', 'Perera', { expires: 365 });
            Cookies.set('Name4', 'Amarasinghe', { expires: 365 });

            var url = window.location.href;
            //console.log(url);
            var domain = new URL(url);
            domain = domain.hostname;
            //console.log(domain);
            Cookies.set('DomainTest' , 'DomainTest', { expires: 365, domain: domain });


            $(function() {
                    
                }
            );
            

        </script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
        <button id="cookie-button">Click</button>
        <button id="manage-cookies">Manage Cookies</button>
        <script>

            var FPCP_config = '';

            $("#cookie-button").click(function() {
                setCookie('ButtonClick', 'This is button click cookie', 3);
            });

            $("#manage-cookies").click(function() {
                manageCookies();
            });
            
            window.addEventListener("load", function(){
                managePreferencesForExternalCookies();
            });
            

            function managePreferencesForExternalCookies(pageLoad = true){
                var url = window.location.href;
                var domain = new URL(url);
                domain = domain.hostname;

                var isPerformanceCookieEnabled = isPerformanceCookieEnable();
                var isMarketingCookieEnabled  = isMarketingCookieEnable();
                var isFunctionalCookieEnabled  = isFunctionalCookieEnable();

                $.getJSON("/cookie_test/js/external_cookies.json", function(json) {
                    //console.log(json);

                    /*if(pageLoad === true){
                        setInterval(function(){
                            json.cookies.forEach(function(cookie){
                                var removeThisCookie = false;
                                if(cookie.domainWithWWW === false){
                                    domain  = domain.replace("www.",'');
                                }

                                switch(cookie.category){
                                    case 2:
                                        if(isPerformanceCookieEnabled === false){
                                            //console.log('isPerformanceCookieEnabled=false');
                                            removeThisCookie = true;
                                        }
                                    break;

                                    case 3:
                                        if(isMarketingCookieEnabled === false){
                                            //console.log('isMarketingCookieEnabled=false');
                                            removeThisCookie = true;
                                        }
                                    break;

                                    case 4:
                                        if(isFunctionalCookieEnabled === false){
                                            //console.log('isFunctionalCookieEnabled=false');
                                            removeThisCookie = true;
                                        }
                                    break;
                                }
                                //console.log(cookie.name+'/'+cookie.category);
                                //console.log(removeThisCookie);
                                if(removeThisCookie){
                                    Cookies.remove(cookie.name, { path: '/', domain: domain });
                                }
                            });
                        }, 1000);
                    }else{
                        json.cookies.forEach(function(cookie){
                                if(cookie.domainWithWWW === false){
                                    domain  = domain.replace("www.",'');
                                }
                                Cookies.remove(cookie.name, { path: '/', domain: domain });
                        });
                    }*/



                    json.cookies.forEach(function(cookie){
                        var removeThisCookie = false;
                        if(cookie.domainWithWWW === false){
                            domain  = domain.replace("www.",'');
                        }
                        switch(cookie.category){
                            case 2:
                                if(isPerformanceCookieEnabled === false){
                                    //console.log('isPerformanceCookieEnabled=false');
                                    removeThisCookie = true;
                                }
                            break;

                            case 3:
                                if(isMarketingCookieEnabled === false){
                                    //console.log('isMarketingCookieEnabled=false');
                                    removeThisCookie = true;
                                }
                            break;

                            case 4:
                                if(isFunctionalCookieEnabled === false){
                                    //console.log('isFunctionalCookieEnabled=false');
                                    removeThisCookie = true;
                                }
                            break;
                        }
                        //console.log(cookie.name+'/'+cookie.category);
                        //console.log(removeThisCookie);
                        if(removeThisCookie){
                            Cookies.remove(cookie.name, { path: '/', domain: domain });
                        }
                    });
                    
                });
            }

            function isPerformanceCookieEnable() {
                return getCookieConfigVal(1);
            }

            function isMarketingCookieEnable() {
                return getCookieConfigVal(2);
            }

            function isFunctionalCookieEnable() {
                return getCookieConfigVal(3);
            }

            function getCookieConfigVal(index) {
                if (FPCP_config == undefined || FPCP_config == '') {
                    FPCP_config = Cookies.get('FPCPConfig');
                }
                if (FPCP_config != undefined && FPCP_config != '') {
                    var list = FPCP_config.split(';');
                    //console.log(index);
                    //console.log(list);
                    if (list != undefined && list.length == 4) {
                        var val = list[index];
                        //console.log(val);
                        if (val != undefined) {
                            var vals = val.split('-');
                            if (vals != undefined && vals.length == 2 && vals[1] == 1) {
                                return true;
                            }
                        }
                    }
                }
                return false;
            }
        </script>
        <script src="" async defer></script>
    </body>
</html>